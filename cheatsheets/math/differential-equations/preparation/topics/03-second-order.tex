\section{Неоднородные линейные разностные уравнения}\label{sec:inhomogeneous}

\begin{center}
\fbox{\parbox{0.9\textwidth}{
\textbf{Пример.} Решите неоднородное линейное разностное уравнение:
\begin{align}
y_{t+3} - 3y_{t+2} + 6y_{t+1} - 4y_t = 2^t + t
\end{align}
}}
\end{center}

\textbf{Определение.} Линейное неоднородное разностное уравнение порядка $k$ с постоянными коэффициентами:
\begin{align}
a_t + c_1 a_{t-1} + c_2 a_{t-2} + \dots + c_k a_{t-k} = f(t), \quad c_k \neq 0
\end{align}

где $f(t)$ — заданная функция (неоднородность).

\textbf{Структура общего решения:} $a_t = a_t^{(h)} + a_t^{(p)}$, где:
\begin{itemize}
\item $a_t^{(h)}$ — общее решение однородного уравнения (см. раздел~\ref{sec:homogeneous})
\item $a_t^{(p)}$ — частное решение неоднородного уравнения
\end{itemize}

\textbf{Метод неопределённых коэффициентов для $a_t^{(p)}$.}

Пусть характеристический многочлен однородного уравнения:
\[
\chi(r) = r^k + c_1 r^{k-1} + \dots + c_k
\quad \text{и} \quad
\chi(r) = \prod_i (r-r_i)^{m_i} \prod_\ell Q_{\rho_\ell, \theta_\ell}(r)^{s_\ell},
\]
где
\[
Q_{\rho,\theta}(r) = (r - \rho e^{i\theta})(r - \rho e^{-i\theta}) = r^2 - 2\rho \cos\theta \, r + \rho^2.
\]

\textbf{Правило «множитель $\to$ вклад» (однородная часть):}

\begin{itemize}
\item Линейный $(r-r_0)^m \;\Rightarrow\; \sum_{j=0}^{m-1} \alpha_j t^j r_0^t.$

\item Квадратный $Q_{\rho,\theta}(r)^s \;\Rightarrow\;
\rho^t \Bigl( \sum_{j=0}^{s-1} t^j \bigl(a_j \cos(\theta t) + b_j \sin(\theta t)\bigr)\Bigr).$
\end{itemize}

\textbf{Итог:} $a_t^{(h)}$ — сумма всех таких вкладов по всем множителям $\chi$.

\textbf{Выбор формы частного решения $a_t^{(p)}$:}

\textit{Обозначения:} $P_n(t)$ — полином степени $n$; $Q_n(t), R_n(t)$ — полиномы; $\lambda\in\mathbb{C}$; $s$ — кратность резонанса (кратность соответствующего множителя в $\chi$).

\begin{table}[h!]
\centering
\caption{Выбор формы частного решения и проверка резонанса}
\label{tab:particular-form}
\begin{tabular}{|l|l|l|}
\hline
\textbf{Неоднородность $f(t)$} & \textbf{Проверка резонанса} & \textbf{Базовая форма $a_t^{(p)}$} \\
\hline
$P_n(t)\,\lambda^t$ & $\chi(\lambda)=0?$ & $Q_n(t)\,\lambda^t$ \\
\hline
$\rho^t\cos(\theta t)$, $\rho^t\sin(\theta t)$ & $Q_{\rho,\theta}(r)\mid \chi(r)?$ & $\rho^t\big(A\cos(\theta t)+B\sin(\theta t)\big)$ \\
\hline
$P_n(t)\,\rho^t\cos(\theta t)$ (или $\sin$) & $Q_{\rho,\theta}(r)\mid \chi(r)?$ & $\rho^t\big(Q_n(t)\cos(\theta t)+R_n(t)\sin(\theta t)\big)$ \\
\hline
Чистый полином $P_n(t)$ & $\chi(1)=0?$ & $Q_n(t)$ \\
\hline
\end{tabular}
\end{table}

\textbf{Правило резонанса:} если проверка даёт резонанс кратности $s$, домножьте базовую форму на $t^{s}$.

\begin{center}
\fbox{\parbox{0.92\textwidth}{
\textbf{Алгоритм решения неоднородного уравнения.}
\begin{enumerate}
\item \textbf{Однородная часть.} Найти $a_t^{(h)}$ методом характеристических корней (см. раздел~\ref{sec:homogeneous}).
\item \textbf{Форма частного решения.} По таблице~\ref{tab:particular-form} выбрать форму $a_t^{(p)}$ с учётом правила резонанса.
\item \textbf{Подстановка.} Подставить $a_t^{(p)}$ в исходное неоднородное уравнение и найти неопределённые коэффициенты.
\item \textbf{Общее решение.} $a_t = a_t^{(h)} + a_t^{(p)}$.
\item \textbf{Начальные условия.} Подставить $k$ заданных значений и найти константы в $a_t^{(h)}$.
\end{enumerate}
}}
\end{center}

\bigskip

\begin{center}
\fbox{\parbox{0.92\textwidth}{
\textbf{Пример.} Решите разностное уравнение третьего порядка с постоянными коэффициентами:
\[
y_{t+3} - 3y_{t+2} + 6y_{t+1} - 4y_t = 2^t + t
\]
Найти общее решение $y_t$.
}}
\end{center}

\bigskip

\begin{center}
\fbox{\parbox{0.92\textwidth}{
\noindent\textbf{Решение.}

\paragraph{1) Однородная часть.}
Характеристический многочлен:
\[
\chi(r)=r^3-3r^2+6r-4=(r-1)(r^2-2r+4),
\]
корни: $r_1=1$, $r_{2,3}=1\pm i\sqrt{3}=2e^{\pm i\pi/3}$.

Отсюда
\[
y_t^{(h)} = C_1 + 2^t\Big(C_2\cos\tfrac{\pi t}{3} + C_3\sin\tfrac{\pi t}{3}\Big).
\]

\paragraph{2) Частное решение $y_t^{(p)}$.}
Правая часть $f(t) = 2^t + t$ — сумма двух типов.

\textit{Экспонента $2^t$:} $\chi(2) = 8 - 12 + 12 - 4 = 4 \neq 0 \Rightarrow$ резонанса нет, берём $y^{(p)}_{(1)} = \alpha\,2^t$.

\textit{Полином $t$:} $\chi(1) = 0$ (кратность $1$) $\Rightarrow$ резонанс порядка $s=1$. Базовая форма для $P_1(t)$ — $At+B$, домножаем на $t$:
\[
y^{(p)}_{(2)} = t(At+B) = At^2 + Bt.
\]
Итого
\[
y_t^{(p)} = \alpha\,2^t + At^2 + Bt.
\]

\paragraph{3) Подстановка и определение коэффициентов.}
Обозначим линейный оператор:
\[
\mathcal{L}[y_t] = y_{t+3} - 3y_{t+2} + 6y_{t+1} - 4y_t.
\]

Для экспоненты: $\mathcal{L}[2^t] = \chi(2)\,2^t = 4\cdot2^t \Rightarrow 4\alpha\,2^t = 2^t$, значит $\alpha = \tfrac{1}{4}$.

Для полинома $At^2 + Bt$ прямой подсчёт даёт:
\[
\mathcal{L}[At^2 + Bt] = 6A\,t + (3A + 3B).
\]
Требуем $\mathcal{L}[At^2 + Bt] = t$, откуда
\[
6A = 1 \Rightarrow A = \tfrac{1}{6}, \qquad 3A + 3B = 0 \Rightarrow B = -\tfrac{1}{6}.
\]
Следовательно,
\[
y_t^{(p)} = \frac{1}{4}\,2^t + \frac{t^2 - t}{6}.
\]

\paragraph{4) Общее решение.}
\[
\boxed{
y_t = C_1 + 2^t\Big(C_2\cos\tfrac{\pi t}{3} + C_3\sin\tfrac{\pi t}{3}\Big)
+ \frac{1}{4}\,2^t + \frac{t^2 - t}{6}
}
\]
(константы $C_1, C_2, C_3$ находятся по начальным условиям).
}}
\end{center}


