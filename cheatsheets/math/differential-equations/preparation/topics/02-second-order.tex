\section{Неоднородные линейные разностные уравнения}\label{sec:inhomogeneous}

\begin{center}
\fbox{\parbox{0.9\textwidth}{
\textbf{Пример.} Решите неоднородное линейное разностное уравнение:
\begin{align}
y_{t+3} - 3y_{t+2} + 6y_{t+1} - 4y_t = 2^t + t
\end{align}
}}
\end{center}

\textbf{Определение.} Линейное неоднородное разностное уравнение порядка $k$ с постоянными коэффициентами:
\begin{align}
a_t + c_1 a_{t-1} + c_2 a_{t-2} + \dots + c_k a_{t-k} = f(t), \quad c_k \neq 0
\end{align}

где $f(t)$ — заданная функция (неоднородность).

\textbf{Структура общего решения:} $a_t = a_t^{(h)} + a_t^{(p)}$, где:
\begin{itemize}
\item $a_t^{(h)}$ — общее решение однородного уравнения (см. раздел~\ref{sec:homogeneous})
\item $a_t^{(p)}$ — частное решение неоднородного уравнения
\end{itemize}

\textbf{Метод неопределённых коэффициентов для $a_t^{(p)}$.}

Пусть характеристический многочлен однородного уравнения:
\[
\chi(r) = r^k + c_1 r^{k-1} + \dots + c_k
\quad \text{и} \quad
\chi(r) = \prod_i (r-r_i)^{m_i} \prod_\ell Q_{\rho_\ell, \theta_\ell}(r)^{s_\ell},
\]
где
\[
Q_{\rho,\theta}(r) = (r - \rho e^{i\theta})(r - \rho e^{-i\theta}) = r^2 - 2\rho \cos\theta \, r + \rho^2.
\]

\textbf{Правило «множитель $\to$ вклад» (однородная часть):}

\begin{itemize}
\item Линейный $(r-r_0)^m \;\Rightarrow\; \sum_{j=0}^{m-1} \alpha_j t^j r_0^t.$

\item Квадратный $Q_{\rho,\theta}(r)^s \;\Rightarrow\;
\rho^t \Bigl( \sum_{j=0}^{s-1} t^j \bigl(A_j \cos(\theta t) + B_j \sin(\theta t)\bigr)\Bigr).$
\end{itemize}

\textbf{Итог:} $a_t^{(h)}$ — сумма всех таких вкладов по всем множителям $\chi$.

\textbf{Выбор формы частного решения $a_t^{(p)}$:}

\textit{Обозначения:} $P_n(t)$ — полином степени $n$; $Q_n(t), R_n(t)$ — полиномы; $\lambda\in\mathbb{C}$; $s$ — кратность резонанса (кратность соответствующего множителя в $\chi$).

\begin{table}[h!]
\centering
\caption{Выбор формы частного решения и проверка резонанса}
\label{tab:particular-form}
\begin{tabular}{|l|l|l|}
\hline
\textbf{Неоднородность $f(t)$} & \textbf{Проверка резонанса} & \textbf{Базовая форма $a_t^{(p)}$} \\
\hline
$P_n(t)\,\lambda^t$ & $\chi(\lambda)=0?$ & $Q_n(t)\,\lambda^t$ \\
\hline
$\rho^t\cos(\theta t)$, $\rho^t\sin(\theta t)$ & $Q_{\rho,\theta}(r)\mid \chi(r)?$ & $\rho^t\big(A\cos(\theta t)+B\sin(\theta t)\big)$ \\
\hline
$P_n(t)\,\rho^t\cos(\theta t)$ (или $\sin$) & $Q_{\rho,\theta}(r)\mid \chi(r)?$ & $\rho^t\big(Q_n(t)\cos(\theta t)+R_n(t)\sin(\theta t)\big)$ \\
\hline
Чистый полином $P_n(t)$ & $\chi(1)=0?$ & $Q_n(t)$ \\
\hline
\end{tabular}
\end{table}

\textbf{Правило резонанса:} если проверка даёт резонанс кратности $s$, домножьте базовую форму на $t^{s}$.

\begin{center}
\fbox{\parbox{0.9\textwidth}{
\textbf{Алгоритм решения неоднородного уравнения.}
\begin{enumerate}
\item \textbf{Однородная часть.} Найти $a_t^{(h)}$ методом характеристических корней (см. раздел~\ref{sec:homogeneous}).
\item \textbf{Форма частного решения.} По таблице~\ref{tab:particular-form} выбрать форму $a_t^{(p)}$ с учётом правила резонанса.
\item \textbf{Подстановка.} Подставить $a_t^{(p)}$ в исходное неоднородное уравнение и найти неопределённые коэффициенты.
\item \textbf{Общее решение.} $a_t = a_t^{(h)} + a_t^{(p)}$.
\item \textbf{Начальные условия.} Подставить $k$ заданных значений и найти константы в $a_t^{(h)}$.
\end{enumerate}
}}
\end{center}
